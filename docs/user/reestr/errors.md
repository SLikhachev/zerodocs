# Ошибки - Исправление ошибок в реестрах

Пункт меню "Ошибки":

![Меню "Ошибки"](./images/menu_errors.png)

## Импорт ошибок

Для корректировки талонов не притятых в МИС ТФОМС, нужно выгрузить протокол ошибок из
МИС ТФОМС и импортировать его в приложение.

Структура записи пртокола ошибок МИС ТФОМС, которая импортируется приложением,
приведена в разделе [Протокол ошибок МИС ТФОМС](../../admin/tk_errors.md).

Файл протокола должен иметь расшиоение __"xml"__. Если из МИС ТФОМС выгружается
архивный файл __"zip"__, то перед импортом его необходимо распаковать.

Импорт протокола выполняется в форме:

![Импорт протокола"](./images/import_errors.png)

В настоящей версии приложения, загрузить можно только протокол для пакета амбулаторной
помощи, поэтому в поле выбора _"Тип счета"_ должена быть строка выбора _"Амбулаторный"_.

Выбор локального файла для загрузки производится кликом по строке __"Выбрать файл"__.

Импорт выполняется по клику на кнопку _"Импорт"_. На время работы программы форма
блокируется для ввода. Справа от формы располагается информационнаая панель в котрой
по завершении проверки выводится строка с результатом.

Например:

![Импорт ошибок завершен"](./images/errors_form_done.png)

### Строка "Cтатус обработки"

В строке указано:

- имя импортированного файла;
- количество импортрованных записей;
- суммарное время работы приложения.

## Показать последние - Исправление ошибок

Записи об ошибках импортируются в таблицу рабочей базы данных МО. Перед импортом,
таблица полностью очищается от всех записей.

Для просмотра таблицы импортированных ощибок нужно кликнуть по пункту меню
_"Показать последние"_.

![Показать последние"](./images/errors_show_last.png)

### Таблица ошибок

В таблицу выводятся 50 первых записей из таблицы ошибок рабочей БД. Если протокол
не принимался, в таблице будт записи протокола, котрый был ипортирован последний раз,
то есть, автоматически последние импортированные записи не удаляются, но хранятся в
таблице БД до момента очердного импорта протокола.

В таблице ошибок семь колонoк:

- номер талона;
- номер карты;
- фамилия пациента;
- дата открытия талона;
- дата закрытия талона;
- номер ошибки;
- описание ошибки.

Номера талонов и карт являются гиперссылками на соответвующие талон и карту, и по клику
откроют в новой вкладке боаузера форму редактирования талона/карты соответвенно.

В рабочей БД МО должна присутсвовать таблица с номерами и описанием ошибок, которые
генерирует МИС ТФОМС на момент выгрузки протокола. Порядок создание и обновление такой
таблицы описаны в разделе [Отказы МИС ТФОМС](../../admin/tk_errors.md#отказы-мис-тфомс)

### Выгрузка ошибок в CSV

Приложение предоставляет возможность выгрузки все таблицы принятых ошибок в текстовый
файл в формате CSV (значения, разделенные `;`). Для выгрузки нужно кликгуть по кнопке
_"Выгрузить"_.
