# Рабочая база данных

В качестве рабочей базы данных используется реляционная СУБД Postgresql версии не ниже 13.0.
Сервер рабочей БД нужно размещать в локальной или виртуальной частной сети МО.
Если для сервера БД будет использоваться отдельный хост, то необходимо настроить доступ к
серверу по IP адресу хоста в локальной сети. Если сервер [Postgrest](./pg_rest.md) и/или
сервер [Taskrest](./task_rest.md) будут находится на том же хосте что и сервер БД, доступ к
серверу БД для соответствующего сервера приложения можно настроить по unix сокету.

## Схема БД, миграция

Для создания и управления миграцией схемы БД, используется легкий фреймворк с открытым
исходным кодом <a href="https://github.com/amacneil/dbmate/releases" target=_blank>__dbmate__</a>.
Использование данного инструмента не является обязательным. Техничский персонал МО по
своему усмотрению выбирает подходящие средства для управления миграцией схемы, резервного
копирования и восстановления рабочей БД.

### Схема рабочей БД

Актуальная схемы рабочей БД располагается по адресу:
<a href="https://taskrest.omslite.site/utils/file/db/schema/schema_latest.tar.gz">__schema_latest.tar.gz__</a>.

В скачанном архиве находятся:

- файл __schema.sql__ (собственно схема);
- каталог __db__, содержащий все миграции БД, включая последнюю.

Если администратор БД МО не использует __dbmate__, он должен убедится, что все миграции
схемы были проведены последовательно и корректно, с помощью инструмента, используемого МО.

### Дамп рабочей БД

Поскольку БД содержит общие справочники, такие как:

- Перечень МО РФ;
- Перечень СМО РФ;
- и т. д.

МО имеет возможность скачать самый последний дамп _Демо БД_ по адресу:
<a href="https://taskrest.omslite.site/utils/file/db/dump/dump_latest.back">__dump_latest.back__</a>. Дамп сделан с помощью утитлиты pg_dump.

В актуальной версии сервиса все таблицы общих справочников находятся в одном дампе БД.
